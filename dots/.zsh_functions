# Simple calculator
function calc() {
  while true; do read i; echo $[$i]; done
}


# Create a new directory and enter it
function mkd() {
  mkdir -p "$@" && cd "$_";
}


# Open Chrome Canary
chrome () {
  open -a "/Applications/Google\ Chrome\ Canary.app/Contents/MacOS/Google\ Chrome\ Canary" "$1"
}


# Start NZXT Kraken
kraken () {
  liquidctl initialize all;
  liquidctl --match kraken set pump speed 20 30 45 60 50 70 60 80 70 100;
}


# Time tracking
function tt() {
  currentDate=`date +%s`;
  clear;

  while true; do
    echo -ne "$(date -u -jf "%s" $((`date +%s` - $currentDate)) +%H:%M:%S)\r";
    sleep 0.1
  done
}


# Create a .tar.gz archive, using `zopfli`, `pigz` or `gzip` for compression
function targz() {
  local tmpFile="${@%/}.tar";
  tar -cvf "${tmpFile}" --exclude=".DS_Store" "${@}" || return 1;

  size=$(
    stat -f"%z" "${tmpFile}" 2> /dev/null; # OS X `stat`
    stat -c"%s" "${tmpFile}" 2> /dev/null # GNU `stat`
  );

  local cmd="";
  if (( size < 52428800 )) && hash zopfli 2> /dev/null; then
    # the .tar file is smaller than 50 MB and Zopfli is available; use it
    cmd="zopfli";
  else
    if hash pigz 2> /dev/null; then
      cmd="pigz";
    else
      cmd="gzip";
    fi;
  fi;

  echo "Compressing .tar using \`${cmd}\`â€¦";
  "${cmd}" -v "${tmpFile}" || return 1;
  [ -f "${tmpFile}" ] && rm "${tmpFile}";
  echo "${tmpFile}.gz created successfully.";
}


# `o` with no arguments opens the current directory, otherwise opens the given
# location
function o() {
  if [ $# -eq 0 ]; then
    open .;
  else
    open "$@";
  fi;
}
