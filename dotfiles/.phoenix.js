"use strict";var et=Object.create;var Te=Object.defineProperty;var tt=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames;var it=Object.getPrototypeOf,rt=Object.prototype.hasOwnProperty;var ot=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var st=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of nt(e))!rt.call(n,r)&&r!==t&&Te(n,r,{get:()=>e[r],enumerable:!(i=tt(e,r))||i.enumerable});return n};var at=(n,e,t)=>(t=n!=null?et(it(n)):{},st(e||!n||!n.__esModule?Te(t,"default",{value:n,enumerable:!0}):t,n));var Oe=ot(($t,ie)=>{"use strict";var gt=Object.prototype.hasOwnProperty,g="~";function z(){}Object.create&&(z.prototype=Object.create(null),new z().__proto__||(g=!1));function yt(n,e,t){this.fn=n,this.context=e,this.once=t||!1}function Qe(n,e,t,i,r){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new yt(t,i||n,r),u=g?g+e:e;return n._events[u]?n._events[u].fn?n._events[u]=[n._events[u],o]:n._events[u].push(o):(n._events[u]=o,n._eventsCount++),n}function G(n,e){--n._eventsCount===0?n._events=new z:delete n._events[e]}function w(){this._events=new z,this._eventsCount=0}w.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)gt.call(t,i)&&e.push(g?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};w.prototype.listeners=function(e){var t=g?g+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,o=i.length,u=new Array(o);r<o;r++)u[r]=i[r].fn;return u};w.prototype.listenerCount=function(e){var t=g?g+e:e,i=this._events[t];return i?i.fn?1:i.length:0};w.prototype.emit=function(e,t,i,r,o,u){var c=g?g+e:e;if(!this._events[c])return!1;var s=this._events[c],f=arguments.length,p,l;if(s.fn){switch(s.once&&this.removeListener(e,s.fn,void 0,!0),f){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,t),!0;case 3:return s.fn.call(s.context,t,i),!0;case 4:return s.fn.call(s.context,t,i,r),!0;case 5:return s.fn.call(s.context,t,i,r,o),!0;case 6:return s.fn.call(s.context,t,i,r,o,u),!0}for(l=1,p=new Array(f-1);l<f;l++)p[l-1]=arguments[l];s.fn.apply(s.context,p)}else{var te=s.length,L;for(l=0;l<te;l++)switch(s[l].once&&this.removeListener(e,s[l].fn,void 0,!0),f){case 1:s[l].fn.call(s[l].context);break;case 2:s[l].fn.call(s[l].context,t);break;case 3:s[l].fn.call(s[l].context,t,i);break;case 4:s[l].fn.call(s[l].context,t,i,r);break;default:if(!p)for(L=1,p=new Array(f-1);L<f;L++)p[L-1]=arguments[L];s[l].fn.apply(s[l].context,p)}}return!0};w.prototype.on=function(e,t,i){return Qe(this,e,t,i,!1)};w.prototype.once=function(e,t,i){return Qe(this,e,t,i,!0)};w.prototype.removeListener=function(e,t,i,r){var o=g?g+e:e;if(!this._events[o])return this;if(!t)return G(this,o),this;var u=this._events[o];if(u.fn)u.fn===t&&(!r||u.once)&&(!i||u.context===i)&&G(this,o);else{for(var c=0,s=[],f=u.length;c<f;c++)(u[c].fn!==t||r&&!u[c].once||i&&u[c].context!==i)&&s.push(u[c]);s.length?this._events[o]=s.length===1?s[0]:s:G(this,o)}return this};w.prototype.removeAllListeners=function(e){var t;return e?(t=g?g+e:e,this._events[t]&&G(this,t)):(this._events=new z,this._eventsCount=0),this};w.prototype.off=w.prototype.removeListener;w.prototype.addListener=w.prototype.on;w.prefixed=g;w.EventEmitter=w;typeof ie<"u"&&(ie.exports=w)});var Pe="/Users/marcosmoura/Projects/personal/dotfiles/packages/phoenix/src/assets/icon-reload.png";var C=["command","option"],b=["command","option","control"],Q=[...C,"shift"],ct=[...b,"shift"],be=1.25,Ee=["Displaperture","Console"],m=16,ne=m/2,Ae=3,O={moveWindowToNextScreen:["left",b],moveWindowToPreviousScreen:["right",b],reloadConfig:["r",b],reloadSpace:["l",Q],reloadLayout:["l",ct],reloadYabai:["y",b],toggleMaximized:["m",Q],toggleGrid:["g",Q],toggleColumn:["c",Q],toggleRow:["r",Q],maximize:["up",b],centralize:["down",b],alignToTop:["up",C],alignToBottom:["down",C],alignToRight:["right",C],alignToLeft:["left",C],lockScreen:["l",b]};var Se="/Users/marcosmoura/Projects/personal/dotfiles/packages/phoenix/src/assets/icon-window.png";function ft(n,e=Se){let t=new Modal;return t.animationDuration=0,t.duration=be,t.text=n,t.weight=24,e&&(t.icon=Image.fromFile(e)),t}function F(n,e){let t=ft(n,e),{height:i,width:r}=t.frame(),o=Screen.main().visibleFrame();return t.origin={x:o.x+o.width/2-r/2,y:o.y+o.height/2-i/2},t.show(),t}function I(n,e=C,t){let i=Array.isArray(e)?e:[e];Key.on(n,i,t)}function dt(){I(...O.reloadConfig,()=>Phoenix.reload())}var We=dt;var ht=new Set(["Finder"]);function pt(){let n,e=0,t=!1,i;function r(){e=0,t=!1,clearTimeout(i),I("q","cmd",()=>{let o=App.focused();!o||ht.has(o.name())||(n&&n.close(),t||(n=F("\u2318Q",null)),clearTimeout(i),e<15?(e++,i=setTimeout(()=>{e=0},50)):(t||(t=App.focused().terminate()),i=setTimeout(()=>r(),50)))})}r()}var Le=pt;var Ie=Me;function Me(){var n=[].slice.call(arguments),e=!1;typeof n[0]=="boolean"&&(e=n.shift());var t=n[0];if(Ce(t))throw new Error("extendee must be an object");for(var i=n.slice(1),r=i.length,o=0;o<r;o++){var u=i[o];for(var c in u)if(Object.prototype.hasOwnProperty.call(u,c)){var s=u[c];if(e&&mt(s)){var f=Array.isArray(s)?[]:{};t[c]=Me(!0,Object.prototype.hasOwnProperty.call(t,c)&&!Ce(t[c])?t[c]:f,s)}else t[c]=s}}return t}function mt(n){return Array.isArray(n)||{}.toString.call(n)=="[object Object]"}function Ce(n){return!n||typeof n!="object"&&typeof n!="function"}var Fe=wt;function wt(n,e){if(!Array.isArray(n))throw new Error("expected an array for the first argument");if(e!=null&&typeof e!="number")throw new Error("expected a number or null/undefined for the second argument");e=e??n.length;for(var t=n.length,i=[],r=0;r<t;r+=e)i.push(n.slice(r,r+e));return i}var Be=at(Oe(),1);var k=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},re=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},ze=n=>globalThis.DOMException===void 0?new re(n):new DOMException(n),ke=n=>{let e=n.reason===void 0?ze("This operation was aborted."):n.reason;return e instanceof Error?e:ze(e)};function oe(n,e,t,i){let r,o=new Promise((u,c)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){u(n);return}if(i={customTimers:{setTimeout,clearTimeout},...i},i.signal){let{signal:s}=i;s.aborted&&c(ke(s)),s.addEventListener("abort",()=>{c(ke(s))})}r=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{u(t())}catch(p){c(p)}return}let s=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,f=t instanceof Error?t:new k(s);typeof n.cancel=="function"&&n.cancel(),c(f)},e),(async()=>{try{u(await n)}catch(s){c(s)}finally{i.customTimers.clearTimeout.call(void 0,r)}})()});return o.clear=()=>{clearTimeout(r),r=void 0},o}function se(n,e,t){let i=0,r=n.length;for(;r>0;){let o=Math.trunc(r/2),u=i+o;t(n[u],e)<=0?(i=++u,r-=o+1):r=o}return i}var M=function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},P,R=class{constructor(){P.set(this,[])}enqueue(e,t){t={priority:0,...t};let i={priority:t.priority,run:e};if(this.size&&M(this,P,"f")[this.size-1].priority>=t.priority){M(this,P,"f").push(i);return}let r=se(M(this,P,"f"),i,(o,u)=>u.priority-o.priority);M(this,P,"f").splice(r,0,i)}dequeue(){let e=M(this,P,"f").shift();return e?.run}filter(e){return M(this,P,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return M(this,P,"f").length}};P=new WeakMap;var d=function(n,e,t,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(n,t):r?r.value=t:e.set(n,t),t},a=function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},h,N,K,A,J,j,$,T,D,v,V,_,q,E,Y,Re,De,qe,Ne,Ke,je,U,ae,ue,X,H,vt=new k,ce=class extends Error{},B=class extends Be.default{constructor(e){var t,i,r,o;if(super(),h.add(this),N.set(this,void 0),K.set(this,void 0),A.set(this,0),J.set(this,void 0),j.set(this,void 0),$.set(this,0),T.set(this,void 0),D.set(this,void 0),v.set(this,void 0),V.set(this,void 0),_.set(this,0),q.set(this,void 0),E.set(this,void 0),Y.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:R,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(r=e.interval)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);d(this,N,e.carryoverConcurrencyCount,"f"),d(this,K,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),d(this,J,e.intervalCap,"f"),d(this,j,e.interval,"f"),d(this,v,new e.queueClass,"f"),d(this,V,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,d(this,Y,e.throwOnTimeout===!0,"f"),d(this,E,e.autoStart===!1,"f")}get concurrency(){return a(this,q,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);d(this,q,e,"f"),a(this,h,"m",X).call(this)}async add(e,t={}){return new Promise((i,r)=>{let o=async()=>{var u,c,s;d(this,_,(c=a(this,_,"f"),c++,c),"f"),d(this,A,(s=a(this,A,"f"),s++,s),"f");try{if(!((u=t.signal)===null||u===void 0)&&u.aborted){r(new ce("The task was aborted."));return}let p=await(this.timeout===void 0&&t.timeout===void 0?e({signal:t.signal}):oe(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?this.timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?a(this,Y,"f"):t.throwOnTimeout)&&r(vt)}));i(p),this.emit("completed",p)}catch(f){r(f),this.emit("error",f)}a(this,h,"m",qe).call(this)};a(this,v,"f").enqueue(o,t),a(this,h,"m",U).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return a(this,E,"f")?(d(this,E,!1,"f"),a(this,h,"m",X).call(this),this):this}pause(){d(this,E,!0,"f")}clear(){d(this,v,new(a(this,V,"f")),"f")}async onEmpty(){a(this,v,"f").size!==0&&await a(this,h,"m",H).call(this,"empty")}async onSizeLessThan(e){a(this,v,"f").size<e||await a(this,h,"m",H).call(this,"next",()=>a(this,v,"f").size<e)}async onIdle(){a(this,_,"f")===0&&a(this,v,"f").size===0||await a(this,h,"m",H).call(this,"idle")}get size(){return a(this,v,"f").size}sizeBy(e){return a(this,v,"f").filter(e).length}get pending(){return a(this,_,"f")}get isPaused(){return a(this,E,"f")}};N=new WeakMap,K=new WeakMap,A=new WeakMap,J=new WeakMap,j=new WeakMap,$=new WeakMap,T=new WeakMap,D=new WeakMap,v=new WeakMap,V=new WeakMap,_=new WeakMap,q=new WeakMap,E=new WeakMap,Y=new WeakMap,h=new WeakSet,Re=function(){return a(this,K,"f")||a(this,A,"f")<a(this,J,"f")},De=function(){return a(this,_,"f")<a(this,q,"f")},qe=function(){var e;d(this,_,(e=a(this,_,"f"),e--,e),"f"),a(this,h,"m",U).call(this),this.emit("next")},Ne=function(){this.emit("empty"),a(this,_,"f")===0&&this.emit("idle")},Ke=function(){a(this,h,"m",ue).call(this),a(this,h,"m",ae).call(this),d(this,D,void 0,"f")},je=function(){let e=Date.now();if(a(this,T,"f")===void 0){let t=a(this,$,"f")-e;if(t<0)d(this,A,a(this,N,"f")?a(this,_,"f"):0,"f");else return a(this,D,"f")===void 0&&d(this,D,setTimeout(()=>{a(this,h,"m",Ke).call(this)},t),"f"),!0}return!1},U=function(){if(a(this,v,"f").size===0)return a(this,T,"f")&&clearInterval(a(this,T,"f")),d(this,T,void 0,"f"),a(this,h,"m",Ne).call(this),!1;if(!a(this,E,"f")){let e=!a(this,h,"a",je);if(a(this,h,"a",Re)&&a(this,h,"a",De)){let t=a(this,v,"f").dequeue();return t?(this.emit("active"),t(),e&&a(this,h,"m",ae).call(this),!0):!1}}return!1},ae=function(){a(this,K,"f")||a(this,T,"f")!==void 0||(d(this,T,setInterval(()=>{a(this,h,"m",ue).call(this)},a(this,j,"f")),"f"),d(this,$,Date.now()+a(this,j,"f"),"f"))},ue=function(){a(this,A,"f")===0&&a(this,_,"f")===0&&a(this,T,"f")&&(clearInterval(a(this,T,"f")),d(this,T,void 0,"f")),d(this,A,a(this,N,"f")?a(this,_,"f"):0,"f"),a(this,h,"m",X).call(this)},X=function(){for(;a(this,h,"m",U).call(this););},H=async function(e,t){return new Promise(i=>{let r=()=>{t&&!t()||(this.off(e,r),i())};this.on(e,r)})};function S(n,e){Array.isArray(n)?n.forEach(t=>Event.on(t,e)):Event.on(n,e)}function le(n=Window.focused().screen()){return n.flippedVisibleFrame()}function fe(n){return{width:n.width-m*2,height:n.height-m*2,x:n.x+m,y:n.y+m}}function W(n,e){let t=fe(le(n)),{width:i,height:r,x:o,y:u}=t;return["right","left"].includes(e)?(i=i/2-ne,e==="right"&&(o=o+i+m)):["top","bottom"].includes(e)&&(r=r/2-ne,e==="bottom"&&(u=u+r+m)),{width:i,height:r,x:o,y:u}}function de(n){for(let e of Object.getOwnPropertyNames(n))delete n[e]}function Ge(n,e){return{window:n||Window.focused(),frame:e||fe(le())}}function he(n,e,t){let{window:i}=Ge(e),r=t||W(i.screen(),n);i.setFrame(r)}function $e(n,e){he("full",n,e)}function Ve(n,e){let{window:t,frame:i}=Ge(n,e),r=1920,o=1080,u=t.frame(),c=u.width<r&&u.height<o,s=c?u.width:r,f=c?u.height:o,p=i.x+i.width/2-s/2,l=i.y+i.height/2-f/2;t.setFrame({width:s,height:f,x:p,y:l})}var ee={space:0,tiling:{mode:"grid",position:"full",maxGridCells:Ae}},me={},we={},ge=new B({concurrency:1,autoStart:!0});function Ye(){de(me),de(we),ge.clear()}function _t(n,e){let t=n.windows({visible:!0});if(t.length>0){let i=t.length,r=t[0].screen(),o=W(r,e.position);t.forEach((u,c)=>{let s=(o.width-m*(i-1))/i,f=o.height,p=o.x+(s+m)*c,l=o.y;u.setFrame({width:s,height:f,x:p,y:l})})}}function xt(n,e){let t=n.windows({visible:!0});if(t.length>0){let i=t.length,r=t[0].screen(),o=W(r,e.position);t.forEach((u,c)=>{let s=o.width,f=(o.height-m*(i-1))/i,p=o.x,l=o.y+(f+m)*c;u.setFrame({width:s,height:f,x:p,y:l})})}}function Tt(n,e){let t=n.windows({visible:!0});if(t.length>0){let i=W(t[0].screen(),e.position);t.forEach(r=>$e(r,i))}}function Ue(n,e){let t=n.windows({visible:!0});if(t.length>0){let i=W(t[0].screen(),e.position);t.forEach(r=>Ve(r,i))}}function Pt(n,e){let t=n.windows({visible:!0});t.length>0&&(e.frame?t.forEach(i=>he(null,i,e.frame)):Ue(n,e))}function bt(n,{position:e,maxGridCells:t}){let i=n.windows({visible:!0});if(i.length>0){let r=i[0].screen(),o=W(r,e),u=i.length>Math.round(t*1.4)?t:2,c=Fe(i,u),s=c.length;c.forEach((f,p)=>{let l=f.length;f.forEach((te,L)=>{let _e=(o.width-m*(l-1))/l,xe=(o.height-m*(s-1))/s,Xe=o.x+(_e+m)*L,Ze=o.y+(xe+m)*p;te.setFrame({width:_e,height:xe,x:Xe,y:Ze})})})}}function He(n){return Ee.map(e=>e.toLowerCase()).includes(n.toLowerCase())}function Et(n){return App.all().filter(i=>{let r=i.name();return r.match(n)&&!He(r)})}function At(n,e){let t=Space.all(),i=null;e===0?i=Space.active()??(n.mainWindow().spaces()[0]||t[0]):i=t[e-1],i&&(i.removeWindows(n.windows()),n.focus(),i.addWindows(n.windows()))}function pe(n,e=ee.space,t=ee.tiling,i=!1){switch(i&&At(n,e),we[n.name()]={space:e,tiling:t},t.mode){case"column":{_t(n,t);break}case"row":{xt(n,t);break}case"maximized":{Tt(n,t);break}case"centered":{Ue(n,t);break}case"grid":{bt(n,t);break}case"floating":{Pt(n,t);break}default:break}}function y(n,e=ee){let t=Ie(!0,{},ee,e),i=Et(n);me[n]=t,i.length>0&&i.forEach(r=>{ge.add(()=>new Promise(o=>{setTimeout(()=>{pe(r,t.space,t.tiling,!0),o(!0)},25)}))})}function ye(n,e=!1){let t=n.name();if(He(t))return;let i=we[t];i?pe(n,i.space,i.tiling,e):Object.entries(me).forEach(([r,o])=>{new RegExp(r).test(t)&&pe(n,o.space,o.tiling,e)})}function Z(){Space.active().windows().forEach(n=>ye(n.app()))}function St(){F("Reloading layouts");let n={};Space.all().forEach(e=>{ge.add(()=>new Promise(t=>{setTimeout(()=>{e.windows().filter(r=>n[r.app().name()]).forEach(r=>ye(r.app(),!0)),t(!0)},25)}))})}function Wt(){S(["appDidLaunch","appDidTerminate","appDidShow","appDidHide","appDidActivate"],n=>ye(n)),S(["windowDidUnminimize","windowDidMinimize","windowDidOpen","windowDidClose"],Z),S("spaceDidChange",Z),S("screensDidChange",Z),I(...O.reloadSpace,Z),I(...O.reloadLayout,St)}var Je=Wt;Phoenix.set({openAtLogin:!0});We();Le();Je();var x={tiling:{mode:"centered"}};function ve(){Ye(),y("(Copy|Bin|About This Mac|Info)",x),y("Activity Monitor",x),y("Calculator",x),y("Contexts",x),y("IINA",x),y("Opening",x),y("Preferences",x),y("Settings",x),y("Preview",x),y("Steam",x),y("System Settings",x),y("Tone Room",x),y("VLC",x)}ve();S("screensDidChange",ve);S("appDidLaunch",ve);F("Phoenix reloaded!",Pe);
